<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julian Amon, PhD">
<meta name="dcterms.date" content="2025-04-04">

<title>Exercises III – cfpu-ds-da</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-1f047e49e03d5949a1de66e547831f65.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-9175887dde49e0f376dc4b42db1796c9.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../exercises/exercises-i.html">Exercises</a></li><li class="breadcrumb-item"><a href="../exercises/exercises-iii.html">Exercises III</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">cfpu-ds-da</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jamon-R/cfpu-ds-da" title="GitHub repo to this website" class="quarto-navigation-tool px-1" aria-label="GitHub repo to this website"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../introduction-to-ds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Data Science</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../the-essentials-of-r-programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Essentials of R Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../the-ds-workflow-i.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Data Science Workflow I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../the-ds-workflow-ii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Data Science Workflow II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../the-ds-workflow-iii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Data Science Workflow III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../the-ds-workflow-iv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Data Science Workflow IV</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercises-i.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercises-ii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercises-iii.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Exercises III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercises-iv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises IV</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Exercise Solutions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercise-solutions-i.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercise-solutions-ii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercise-solutions-iii.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../exercises/exercise-solutions-iv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions IV</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../image_sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Image Sources</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-data-science-workflow-visualize" id="toc-the-data-science-workflow-visualize" class="nav-link active" data-scroll-target="#the-data-science-workflow-visualize">The Data Science Workflow – Visualize</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../exercises/exercises-i.html">Exercises</a></li><li class="breadcrumb-item"><a href="../exercises/exercises-iii.html">Exercises III</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Exercises III</h1>
<p class="subtitle lead">Data Science and Data Analytics</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julian Amon, PhD </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 4, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="the-data-science-workflow-visualize" class="level1">
<h1>The Data Science Workflow – Visualize</h1>
<ol type="1">
<li>Investigating the relationship between age and number of children based on the <code>gss_sm</code> data set:
<ol type="a">
<li>The <code>socviz</code> package contains a data set called <code>gss_sm</code>, which is a small subset of the questions from the 2016 General Social Survey (GSS). The GSS is a long-running survey of American adults that asks about a range of topics of interest to social scientists. To access this data set, start by installing and loading the <code>socviz</code> package.</li>
<li>Start by creating a simple scatter plot of <code>age</code> (on the <code>x</code> axis) against <code>childs</code> (on the <code>y</code> axis), i.e.&nbsp;illustrate how the number of children varies with age.</li>
<li>The plot from task b. suffers from <strong>overplotting</strong>, i.e.&nbsp;many data points are in the same position and overlap. To avoid this, see what happens when you set the <code>position</code> argument of the point geom to <code>"jitter"</code>.</li>
<li>Now, add a smooth line describing the relationship between age and number of children into the plot.</li>
<li>Facet the plot by <code>sex</code> (rows) and <code>race</code> (columns).</li>
<li>Change the theme of the plot to <code>theme_minimal</code>. Also, add axis tick marks on the <code>x</code> axis every 10 years. Finally, choose your favourite colour from <a href="https://images.app.goo.gl/NnTad7XXHyzTAeFV8">here</a> and use its name to colour the points in the plot. Also set their size to 0.25 to make them smaller and further reduce the overplotting issue. Finally, label the axes with <code>Age</code> and <code>Number of Children</code>, respectively.</li>
</ol></li>
<li>Analyzing the relationship between education and political views based on the <code>gss_sm</code> data set:
<ol type="a">
<li>Create a frequency table of the <code>degree</code> variable and save it as a variable called <code>degree_freqs</code>. Turn it into a <code>data.frame</code> with column names <code>degree</code> and <code>freq</code>.</li>
<li>Use the <code>degree_freqs</code> object to create a bar plot indicating the absolute frequencies of the different levels of education in the data set.</li>
<li>Reorder the degrees in the bar plot to reflect the order of their absolute frequencies from highest to lowest. Also, relabel the axes to <code>Education Level</code> and <code>Frequency</code>, respectively.</li>
<li>Now, create a contingency table of the variables <code>degree</code> and <code>polviews</code> and save it as a variable called <code>degrees_polview</code>. Turn it into a <code>data.frame</code> with column names <code>degree</code>, <code>polviews</code> and <code>freq</code>.</li>
<li>Using <code>degrees_polview</code>, create a stacked bar plot of <code>degree</code>, where the <code>fill</code> aesthetic is used to indicate <code>polviews</code>. Afterwards, also create a bar plot of <code>polviews</code>, where the <code>fill</code> aesthetic is used to indicate <code>degree</code>.</li>
<li>Turn both bar plots from task e. into ones that show conditional relative frequencies instead of absolute frequencies to show the relationship between education and political views.</li>
<li>For the first of the two bar plots, add the title “Education and political views”, a subtitle “Data from the 2016 General Social Survey”, a caption “Source: socviz package”, appropriate axes labels and a header for the legend saying “Political views”. Moreover, choose a suitable color palette from the colorbrewer set and apply it to the graph. Finally, use <code>theme_economist_white</code> from the <code>ggthemes</code> package.</li>
<li>Finally, use the code you have already written to also have a look at the relationship between <code>religion</code> and <code>polviews</code>. For the most part, this should just involve some copying and pasting as well as adapting certain labels accordingly. Note that you have to create a new contingency table, of course.</li>
</ol></li>
<li>Analyzing the relationship between economic well-being and life expectancy for countries in the world in 2020 based on the <code>gapminder</code> data set:
<ol type="a">
<li>In the course materials, you should find the data sets called <code>gm_gdp.csv</code>, <code>gm_lex.csv</code>, <code>gm_pop.csv</code> and <code>gm_geo.csv</code>. These data sets all stem from the <a href="https://www.gapminder.org/">Gapminder Project</a>, a Swedish non-profit venture that promotes understanding of information about social, economic, and environmental development through the use of data visualization and statistics. Start by loading all these four data sets into R under the names of <code>gdp</code>, <code>lex</code>, <code>pop</code> and <code>geo</code>, respectively. Inspect these four data sets and familiarize yourself with their structure. Refer to <code>gm_description.csv</code> for additional information if you need it. Rename the following columns:
<ul>
<li>the fourth column of <code>gdp</code> to <code>gdp_percap</code>.</li>
<li>the third column of <code>lex</code> to <code>time</code> and the fourth column to <code>life_expectancy</code>.</li>
<li>the fourth column of <code>pop</code> to <code>population</code>.</li>
</ul></li>
<li>Perform the following joins in the given order:
<ul>
<li>an inner join between columns 1, 3 and 4 of both <code>gdp</code> and <code>lex</code> on variables <code>geo</code> and <code>time</code>. Call the resulting object <code>gm_df</code>.</li>
<li>an inner join between <code>gm_df</code> and columns 1, 3 and 4 of <code>pop</code> on variables <code>geo</code> and <code>time</code>. Redefine <code>gm_df</code> as the resulting object.</li>
<li>an inner join between <code>gm_df</code> and columns 1, 2 and 3 of <code>geo</code> on variable <code>geo</code>. Redefine <code>gm_df</code> as the resulting object.</li>
</ul></li>
<li>Verify that <code>gm_df</code> now has columns <code>geo</code>, <code>time</code>, <code>gdp_percap</code>, <code>life_expectancy</code>, <code>population</code>, <code>name</code> and <code>four_regions</code>.</li>
<li>We will start by illustrating the relationship between GDP per capita and life expectancy at birth in a single year. For this, create a <code>data.frame</code> called <code>gm_df2020</code> that only includes data points from the year 2020. Using <code>gm_df2020</code>, then create a simple scatter plot of <code>gdp_percap</code> on the <code>x</code> axis and <code>life_expectancy</code> on the <code>y</code> axis.</li>
<li>In the plot, you can see a point at life_expectancy 0. This is because in the year 2020, we do not have life expectancy information for Hong Kong and Liechtenstein. The corresponding values are set to 0, which is not sensible. To avoid this being visible, we can simply restrict the plot range of the <code>y</code> axis. Set it, using <code>scale_y_continuous</code>, to the range from 40 to 95.</li>
<li>Another problem of this plot is that the GDP per capita spans a very wide range of values. To mitigate this for visualization, apply log2-scaling to the <code>x</code> axis. Hint: check the documentation for possible values to pass to the <code>transform</code> argument of the <code>scale_x_continuous</code> function.</li>
<li>To match the log2-scaling of the <code>x</code> axis, set the tick marks at powers of 2 starting from 256 and ending at 131,072.</li>
<li>Now, we want the size of the points to represent the sizes of the country populations. Add the corresponding aesthetic for <code>population</code> to your plot. Control the minimal and maximal sizes of the points via the <code>range</code> argument of <code>scale_size_continuous</code>, the minimum should be 0.5 and the maximum should be 20.</li>
<li>The big size of some points now means that many points are not visible due to overlap. To mitigate this, increase the transparency of the points by setting <code>alpha</code> to 0.4.</li>
<li>Next, it would be nice to represent the four world regions (Africa, Americas, Asia and Europe) by colour. Add the corresponding aesthetic for the variable <code>four_regions</code> and apply a suitable colorbrewer palette of your choosing.</li>
<li>Add the label <code>GDP per capita (log scale)</code> to the <code>x</code> axis and the label <code>Life expectancy at birth</code> to the <code>y</code> axis. Furthermore, add a title saying “Economic well-being and life expectancy”, a subtitle saying “Data from 2020” and a caption saying “Source: gapminder” to the plot. Rename the header of the legend for the world regions to <code>World Region</code>.</li>
<li>Finally, remove the guide for the <code>size</code> aesthetic and change the theme to <code>theme_test</code>.</li>
</ol></li>
<li>Analyzing the relationship between child mortality and total fertility rate over time based on the <code>gapminder</code> data set:
<ol type="a">
<li>We will now merge additional data into the <code>data.frame</code> called <code>gm_df</code> created in exercise 3. First load the data sets <code>gm_tfr.csv</code> and <code>gm_cm.csv</code> into R under the names of <code>tfr</code> and <code>cm</code>. The first contains data on the <strong>total fertility rate</strong> (i.e.&nbsp;number of babies per woman) and the second contains data on <strong>child mortality</strong> (i.e.&nbsp;number of 0-5 year-olds dying per 1000 born children). After import, rename their fourth columns to <code>tfr</code> and <code>cm</code>, respectively.</li>
<li>Perform the following joins in the given order:
<ul>
<li>an inner join between <code>gm_df</code> and columns 1, 3 and 4 of <code>tfr</code> on variables <code>geo</code> and <code>time</code>. Redefine <code>gm_df</code> as the resulting object.</li>
<li>an inner join between <code>gm_df</code> and columns 1, 3 and 4 of <code>cm</code> on variables <code>geo</code> and <code>time</code>. Redefine <code>gm_df</code> as the resulting object.</li>
</ul></li>
<li>Verify that the variables <code>tfr</code> and <code>cm</code> are now available in the <code>data.frame</code> called <code>gm_df</code>.</li>
<li>We want to look at the relationship between child mortality and total fertility rate in six years, namely 1800, 1900, 1930, 1950, 1980 and 2010. Restrict <code>gm_df</code> to only include data from these six years.</li>
<li>Create a scatter plot with <code>cm</code> on the <code>x</code> axis and <code>tfr</code> on the <code>y</code> axis. Facet the plot by <code>time</code> into a 2 x 3 grid using <code>facet_wrap</code>, such that each subplot represents one of the six years we have pre-selected.</li>
<li>Now, map <code>four_regions</code> and <code>population</code> to the <code>color</code> and <code>size</code> aesthetics, respectively, exactly in the same way as in exercise 3. To prevent too large points dominating the subplots, the only difference should be setting the maximum point size to 10.</li>
<li>This time, we want to be able to read off at least some of the individual countries from the plot. To do this, load the <code>ggrepel</code> package, map the <code>name</code> variable to the <code>label</code> aesthetic and use <code>geom_text_repel</code> with arguments <code>size = 2</code> and <code>max_overlaps = 15</code> to add the labels.</li>
<li>Label the plot appropriately and adapt the overall plot design to conform with the appearance of the final plot from exercise 3.</li>
</ol></li>
<li>Analyzing the relationship between chemical properties of wine and its perceived quality:
<ol type="a">
<li>In exercise set II, you downloaded and imported the Wine Quality data sets from the <a href="https://archive.ics.uci.edu/dataset/186/wine+quality">UCI Machine Learning Repository</a>. Import both of these data sets under the names <code>white_wines</code> and <code>red_wines</code> again. To both <code>data.frames</code>, add a column called <code>type</code>, which is <code>white</code> for all wines in the first one and <code>red</code> for all wines in the second one. Then, using the function <code>rbind</code>, combine the two data frames into one called <code>wines</code>. Finally, turn the variables <code>quality</code> and <code>type</code> into a <code>factor</code>.</li>
<li>First, we want to investigate the relationship between alcohol percentage of the wines and their sensory quality. Create parallel boxplots of the <code>alcohol</code> variable for all observed levels of the <code>quality</code> variable. Use the <code>fill</code> aesthetic to represent the two different types of wine.</li>
<li>Use <code>coord_flip</code> to have <code>quality</code> on the <code>y</code> axis and <code>alcohol</code> on the <code>x</code> axis.</li>
<li>Let’s represent the wines in appropriate colours. Use <code>scale_fill_manual</code> to manually adapt the colours of the <code>fill</code> aesthetic. One way to specify colours in R is with the help of so-called <a href="https://www.color-hex.com/">hex codes</a>, use “#7B0323” for red wines and “#F1EAA3” for white wines. To make these colours visible, choose a theme with a white background, such as <code>theme_test</code>. Finally, label your plot appropriately.</li>
<li>Create further similar plots relating the wine quality to different chemical properties. In particular:
<ul>
<li><code>volatile.acidity</code>. Try using a <code>jitter</code> geom instead of the <code>boxplot</code> geom. Experiment with the point size to reduce the overplotting issue.</li>
<li><code>sulphates</code>. Try using a <code>violin</code> geom this time.</li>
</ul></li>
</ol></li>
<li>Analyzing flipped counties by demographics in the 2016 US presidential election:
<ol type="a">
<li>In the <code>socviz</code> package, there is a data set called <code>county_data</code>, which contains county-level data from the 2016 US presidential election. In this data set, the variable <code>flipped</code> indicates, whether a given county flipped to Republican or Democrat compared to the 2012 election. Start by creating a simple scatter plot of county population (<code>pop</code>) on the <code>x</code> axis and the percentage of black population (<code>black/100</code>) on the <code>y</code> axis, but only for the counties that did <strong>not</strong> flip in the 2016 election. Use a <code>log10</code> scale on the <code>x</code> axis, color the points in <code>grey</code> and increase their transparency by setting <code>alpha = 0.25</code>.</li>
<li>Now, add points for the counties that <strong>did</strong> flip in the 2016 election. You do this simply by adding another <code>point</code> geom, but with its own data set and aesthetic mapping. Map the variable <code>partywinner16</code> (indicating the party to which the county flipped in the election) to the <code>color</code> aesthetic and use the typical Republican and Democrat party colours (which is “#CB454A” for Republican and “#2E74C0” for Democrat) as the colours.</li>
<li>For nicely labeled tick marks, we can use the <code>scales</code> package. Having installed the package, load it and pass the function <code>comma</code> as the <code>labels</code> argument to <code>scale_x_log10</code> and the function <code>percent</code> as the <code>labels</code> argument to <code>scale_y_continuous</code>. Notice how that changes the labels for the tick marks in the plot.</li>
<li>Add the following labels your plot:
<ul>
<li><code>x</code>: County population (log scale)</li>
<li><code>y</code>: Percent black population</li>
<li><code>title</code>: Flipped counties, 2016</li>
<li><code>subtitle</code>: Counties in grey did not flip.</li>
<li><code>caption</code>: Source: socviz package</li>
<li><code>color</code>: County flipped to…</li>
</ul></li>
<li>Use a <code>text_repel</code> geom to label all counties that flipped and have a black population of more than 25% with a label indicating the <code>state</code> they belong to. Set the size of the text to 2. Finally, set the theme to <code>theme_economist</code> from the <code>ggthemes</code> package.</li>
</ol></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/jamon-R\.github\.io\/cfpu-ds-da\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Julian Amon, PhD</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>